/*! UIkit 3.0.0 | http://www.getuikit.com | (c) 2014 - 2016 YOOtheme | MIT License */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("uikit")):"function"==typeof define&&define.amd?define(["uikit"],e):e(t.UIkit)}(this,function(t){"use strict";function e(t){return UIkit.getComponent(t,"sortable")||t.parentNode&&e(t.parentNode)}function i(){var t=setTimeout(function(){return g.trigger("click")},0),e=function e(i){i.preventDefault(),i.stopPropagation(),clearTimeout(t),h(g,"click",e,!0)};l(g,"click",e,!0)}var s=t.util.$,o=t.util.extend,r=t.util.isWithin,n=t.util.Observer,l=t.util.on,h=t.util.off,a=t.util.pointerDown,c=t.util.pointerMove,d=t.util.pointerUp,u=t.util.requestAnimationFrame,p=s(window),g=s(document.documentElement);UIkit.component("sortable",{mixins:[t.mixin.class],props:{group:String,animation:Number,threshold:Number,clsItem:String,clsPlaceholder:String,clsDrag:String,clsDragState:String,clsBase:String,clsNoDrag:String,clsEmpty:String,clsCustom:String,handle:String},defaults:{group:!1,animation:150,threshold:5,clsItem:"uk-sortable-item",clsPlaceholder:"uk-sortable-placeholder",clsDrag:"uk-sortable-drag",clsDragState:"uk-drag",clsBase:"uk-sortable",clsNoDrag:"uk-sortable-nodrag",clsEmpty:"uk-sortable-empty",clsCustom:"",handle:!1},ready:function(){var t=this;if(["init","start","move","end"].forEach(function(e){var i=t[e];t[e]=function(e){e=e.originalEvent||e,t.scrollY=window.scrollY;var s=e.touches&&e.touches[0]||e,o=s.pageX,r=s.pageY;t.pos={x:o,y:r},i(e)}}),l(this.$el,a,this.init),this.clsEmpty){var e=function(){return t.$el.toggleClass(t.clsEmpty,!t.$el.children().length)};new n(e).observe(this.$el[0],{childList:!0}),e()}},methods:{init:function(t){var e=s(t.target),i=this.$el.children().filter(function(e,i){return r(t.target,i)});!i.length||e.is(":input")||this.handle&&!r(e,this.handle)||t.button&&0!==t.button||r(e,"."+this.clsNoDrag)||(t.preventDefault(),t.stopPropagation(),this.touched=[this],this.placeholder=i,this.origin=o({target:e,index:this.placeholder.index()},this.pos),g.on(c,this.move),g.on(d,this.end),p.on("scroll",this.scroll),this.threshold||this.start(t))},start:function(e){this.drag=s(this.placeholder[0].outerHTML.replace(/^<li/i,"<div").replace(/li>$/i,"div>")).attr("uk-no-boot","").addClass(this.clsDrag+" "+this.clsCustom).css({boxSizing:"border-box",width:this.placeholder.outerWidth(),height:this.placeholder.outerHeight(),paddingLeft:this.placeholder.css("paddingLeft"),paddingRight:this.placeholder.css("paddingRight"),paddingTop:this.placeholder.css("paddingTop"),paddingBottom:this.placeholder.css("paddingBottom")}).appendTo(t.container),this.drag.children().first().height(this.placeholder.children().height());var i=this.placeholder.offset(),r=i.left,n=i.top;o(this.origin,{left:r-this.pos.x,top:n-this.pos.y}),this.placeholder.addClass(this.clsPlaceholder),this.$el.children().addClass(this.clsItem),g.addClass(this.clsDragState),this.$el.trigger("start",[this,this.placeholder,this.drag]),this.move(e)},move:function t(i){if(!this.drag)return void((Math.abs(this.pos.x-this.origin.x)>this.threshold||Math.abs(this.pos.y-this.origin.y)>this.threshold)&&this.start(i));this.update();var o="mousemove"===i.type?i.target:document.elementFromPoint(this.pos.x-document.body.scrollLeft,this.pos.y-document.body.scrollTop),n=e(o),l=e(this.placeholder[0]),t=n!==l;if(n&&!r(o,this.placeholder)&&(!t||n.group&&n.group===l.group)){if(o=n.$el.is(o.parentNode)&&s(o)||n.$el.children().has(o),t)l.remove(this.placeholder);else if(!o.length)return;n.insert(this.placeholder,o),this.touched.indexOf(n)===-1&&this.touched.push(n)}},scroll:function t(){var t=window.scrollY;t!==this.scrollY&&(this.pos.y+=t-this.scrollY,this.scrollY=t,this.update())},end:function(t){if(g.off(c,this.move),g.off(d,this.end),p.off("scroll",this.scroll),!this.drag)return void("mouseup"!==t.type&&r(t.target,"a[href]")&&(location.href=s(t.target).closest("a[href]").attr("href")));i();var o=e(this.placeholder[0]);this===o?this.origin.index!==this.placeholder.index()&&this.$el.trigger("change",[this,this.placeholder,"moved"]):(o.$el.trigger("change",[o,this.placeholder,"added"]),this.$el.trigger("change",[this,this.placeholder,"removed"])),this.$el.trigger("stop",[this]),this.drag.remove(),this.drag=null,this.touched.forEach(function(t){return t.$el.children().removeClass(t.clsPlaceholder+" "+t.clsItem)}),g.removeClass(this.clsDragState)},update:function(){var t=this;this.updating||u(function(){if(t.updating=!1,t.drag){t.drag.offset({top:t.pos.y+t.origin.top,left:t.pos.x+t.origin.left});var e=t.drag.offset().top,i=e+t.drag[0].offsetHeight;e>0&&e<t.scrollY?setTimeout(function(){return p.scrollTop(t.scrollY-5)},5):i<g[0].offsetHeight&&i>window.innerHeight+t.scrollY&&setTimeout(function(){return p.scrollTop(t.scrollY+5)},5)}}),this.updating=!0},insert:function t(e,i){var s=this;this.$el.children().addClass(this.clsItem);var t=function(){i.length?!s.$el.has(e).length||e.prevAll().filter(i).length?e.insertBefore(i):e.insertAfter(i):s.$el.append(e),s.$updateParents()};this.animation?this.animate(t):t()},remove:function t(e){var i=this;if(this.$el.has(e).length){var t=function(){e.remove(),i.$updateParents()};this.animation?this.animate(t):t()}},animate:function(t){var e=this,i=[],r=this.$el.children().toArray().map(function(t){return t=s(t),i.push(o({position:"absolute",pointerEvents:"none",width:t.outerWidth(),height:t.outerHeight()},t.position())),t}),n={position:"",width:"",height:"",pointerEvents:"",top:"",left:""};t(),r.forEach(function(t){return t.stop()}),this.$el.children().css(n),this.$updateParents(),this.$el.css("min-height",this.$el.height());var l=r.map(function(t){return t.position()});s.when.apply(s,r.map(function(t,s){return t.css(i[s]).animate(l[s],e.animation).promise()})).then(function(){e.$el.css("min-height","").children().css(n),e.$updateParents()})}}})});